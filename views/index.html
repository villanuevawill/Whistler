<html>
<head>
  <script src="/lib/dsp.js/dsp.js"></script>
  <script src="/lib/microphone.js"></script>
  <script src="/lib/jquery/dist/jquery.min.js"></script>

</head>
<body>
<p class="note">CLICK ME </p>
	<script>
$(function(){
  var mic = new Microphone();
  mic.initialize();

  setInterval(function() {
    console.log(mic.getMaxInputAmplitude());
    if (mic.getMaxInputAmplitude() > -90){
      note = mic.getNote(1);
      $('.note').html(note);
    }
  }, 100);

  $('.note').click(function(){
    mic.startListening();
  })



})


//First step is to set it up so it records, then it will stop recording once sound has stopped for longer than 5 seconds...

//While it's recording, each of the values will be placed into an array... I need a timestamp, and a note-value

//After that, I can start looking at what the array appears to be, and then play around with the synthesis part... Alright, lets give it a shot.

// window.AudioContext = window.AudioContext||window.webkitAudioContext;
//   context = new AudioContext();

// function loadSound() {
//   var request = new XMLHttpRequest();
//   request.open("GET", "http://localhost:8000/music", true); // Path to Audio File
//   request.responseType = "arraybuffer"; // Read as Binary Data

//   request.onload = function() {
//       var incomingData = request.response;
//       play(incomingData);
//   };

//   request.send();
// 	}

// function play(incomingData) {
//     source = context.createBufferSource(); // Create Sound Source
//     buffer = context.createBuffer(incomingData, true); // Create Mono Source Buffer from Raw Binary
//     var filter = context.createBiquadFilter();
//     source.buffer = buffer; // Add Buffered Data to Object
//     source.connect(context.destination); // Connect Sound Source to Output
//     source.noteOn(context.currentTime); // Play the Source when Triggered
// }

// loadSound()
		</script>

	</script>
</body>
</html>